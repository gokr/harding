#!/usr/bin/env ntalk
#
# Boolean.nt - True and false objects with control flow
#

# Note: true and false are defined by the interpreter
# This file adds methods to them for control flow

#====================================================================
# Control flow
#====================================================================

true>>ifTrue: block [
  "Evaluate the block and return its value."
  ^ block value
].

true>>ifFalse: block [
  "Return nil - don't evaluate the block."
  ^ nil
].

true>>ifTrue: trueBlock ifFalse: falseBlock [
  "Evaluate trueBlock and return its value."
  ^ trueBlock value
].

false>>ifTrue: block [
  "Return nil - don't evaluate the block."
  ^ nil
].

false>>ifFalse: block [
  "Evaluate the block and return its value."
  ^ block value
].

false>>ifTrue: trueBlock ifFalse: falseBlock [
  "Evaluate falseBlock and return its value."
  ^ falseBlock value
].

#====================================================================
# Boolean logic
#====================================================================

true>>and: block [
  "Evaluate block and return its value."
  ^ block value
].

true>>or: block [
  "Return true - short circuit."
  ^ true
].

true>>not [
  "Return false."
  ^ false
].

false>>and: block [
  "Return false - short circuit."
  ^ false
].

false>>or: block [
  "Evaluate block and return its value."
  ^ block value
].

false>>not [
  "Return true."
  ^ true
].

#====================================================================
# Comparison
#====================================================================

true>>= other [
  ^ other == true
].

false>>= other [
  ^ other == false
].
